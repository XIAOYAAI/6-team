<!DOCTYPE html>
<!-- saved from url=(0064)http://www.17sucai.com/preview/177065/2016-06-15/Mzu/circle.html -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no"> -->
     <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
    <title>日记墙</title>
    <link href="css/iconfont.css" rel="stylesheet">
    <link href="css/bass.css" rel="stylesheet">
	<link href="css/index.css" rel="stylesheet">
	<style>
    body{
        overflow-x:hidden;
    }
		.main-end{
            width: 60%;
            height: 100%;
            background: #fff;
            position:absolute;
            top:7%;
            left:-60%;
        }
        .main-z{
            width: 100%;
            height: 100%;
            background: url(images/asideBg.png);
        }
        .heiad{
            margin: 0 auto;
            width: 90%;
            height: 3.55rem;
            border-bottom: 0.05rem solid #9C9997;
        }
        .defa{
            width: 1.625rem;
            height: 1.625rem;
            border-radius: 50%;
            margin-top: 0.95rem;
            float: left;
        }
        .heiad span{
            display: inline-block;
            font-size: 0.55rem;
            margin-top: 1.5rem;
            margin-left: 0.2rem;
            
        }
        .hensp-ul{
            width: 100%;
            height: 65%;
            padding-left: 1rem;
            padding-top: 0.5rem;
        }
        .hensp-ul li{
            width: 100%;
            height: 1.6rem;
            margin-bottom: 0.2rem;
            margin-top: 1rem;
        }
        .hensp-ul li img{
            width: 1.6rem;
            height: 1.6rem;
            float: left;
            
        }
        .hensp-ul li span{
            float: left;
            margin: 0.02rem 0 0 0.2rem;
            line-height: 1.6rem;
		}
		.index{
            position: absolute;
            top: 7%;
            left: 7%;
        }
        .user-img  img{
        	width: 2.5rem;
        	height: 2.5rem;
        }
	</style>
</head>
<body>
	<div>
		<header>
			<div class="header">
				<h1>日记墙</h1>
				<a href="#" class="return">三</a>
				<a href="relerse.html" class="comment-btn">+</a>
			</div>
		</header>	
		<div style="height: 2.5rem;"></div>
	</div>
	<!-- 圈子 circle-->
		<!-- circle-content -->
		<div class="main">
			<div class="main-end" id="2" name="">
				<div class="main-z">
					<div class="heiad">
						<img src="images/default.png" alt="" class="defa">
						<span class="Name">新用户</span>
					</div>
					<div class="hensp">
						<ul class="hensp-ul">
							<li><a href="main.html"><img src="images/icon1.png" alt=""><span>主页</span></a></li>
							<li><a href="#"></a><img src="images/icon2.png" alt=""><span>日记墙</span></a></li>
							<li><a href="#"></a><img src="images/icon3.png" alt=""><span>关于我们</span></a></li>
							<li><a href="shangchuang.html"><img src="images/icon4.png" alt=""><span>我的信息</span></a></li>
							<li><a href="index.html"><img src="images/icon5.png" alt=""><span>退出登录</span></a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="index">
				<ul class="circle-content">
				</ul>
			</div>
			
		</div>
	<script src="js/jquery-3.2.1.min.js"></script>
	<script type="text/javascript" src="js/zepto.min.js"></script>
	<script type="text/javascript">
// 滑动
 
var touch = new Touch(document.getElementsByTagName("html"),80).init();
 
//向左滑动触发事件
   
        // var powerOrIncome =this.state.detailsType;
        // let that =this;
            touch.swipeLeft = function (dom) {
            $(".main-end").animate({left:"-60%"},function(){
                $(".main-end").attr('id','2')
            });
              $(".index").animate({left:"7%"});
           //在这添加你的响应事件
            };
 
            //向右滑动事件
            touch.swipeRight = function (dom) {
            $(".main-end").animate({left:"0"},function(){
                $(".main-end").attr('id','1')
            });
            $(".index").animate({left:"67%"});
              //在这添加你的响应事件
            };
 
 
        function Touch(dom,range) {
            this.init = function () {
                var that = this;
                for(var i = 0; i<dom.length; i++){
                    (function (dom) {
                        function touchstart(event) {
                            var e = event || window.event;
                            if(e.targetTouches.length === 1){
                                var startX = e.targetTouches[0].clientX,
                                    startY = e.targetTouches[0].clientY;
                                function touchmove(e) {
                                    var moveEndX = e.targetTouches[0].clientX,
                                        moveEndY = e.targetTouches[0].clientY;
                                    if((that.getAngle(startX,startY,moveEndX,moveEndY) >= 135 || that.getAngle(startX,startY,moveEndX,moveEndY) <= -135) && that.getRange(startX,startY,moveEndX,moveEndY) >= range){
                                        that.swipeLeft(dom);
                                        dom.removeEventListener("touchmove",touchmove);
                                    }else if((that.getAngle(startX,startY,moveEndX,moveEndY) >= -45 && that.getAngle(startX,startY,moveEndX,moveEndY) <= 45)&& that.getRange(startX,startY,moveEndX,moveEndY) >= range){
                                        that.swipeRight(dom);
                                        dom.removeEventListener("touchmove",touchmove);
                                    }
                                }
 
                                function touchend() {
                                    dom.removeEventListener("touchend",touchend);
                                    dom.removeEventListener("touchmove",touchmove);
                                }
 
                                dom.addEventListener("touchmove",touchmove);
                                dom.addEventListener("touchend",touchend);
                            }
                        }
 
                        dom.addEventListener("touchstart",touchstart);
                    })(dom[i]);
                }
 
                return this;
            };
 
            //计算滑动的角度
            this.getAngle = function (px1, py1, px2, py2) {
                //两点的x、y值
                var x = px2-px1;
                var y = py2-py1;
               var  hypotenuse = Math.sqrt(Math.pow(x, 2)+Math.pow(y, 2));
                //斜边长度
               var  cos = x/hypotenuse;
                var radian = Math.acos(cos);
                //求出弧度
               var  angle = 180/(Math.PI/radian);
                //用弧度算出角度
                if (y<0) {
                   var  angle = -angle;
                } else if ((y == 0) && (x<0)) {
                    angle = 180;
                }
                return angle;
            };
            //计算两点之间的距离
            this.getRange = function (px1,py1,px2,py2) {
                return Math.sqrt(Math.pow(Math.abs(px1 - px2), 2) + Math.pow(Math.abs(py1 - py2), 2));
            };
            this.swipeLeft = function (dom) {};
            this.swipeRight = function (dom) {}
        }





		$(document).ready(function(){
			$('.return').click(function(){
                if($(".main-end").attr('id')=='2'){
                    $(".main-end").animate({left:"0"},function(){
                        $(".main-end").attr('id','1')
                    });
                    $(".index").animate({left:"67%"});
                }else{
                    $(".main-end").animate({left:"-60%"},function(){
                        $(".main-end").attr('id','2')
                    });
                    $(".index").animate({left:"7%"});
                }
			})
			
	  	$(".like-i").click(function(){
		    $(".like-i").addClass("like-i-active");
	  	});
	});

$(function(){
    console.log(localStorage.sjh)
	if (localStorage.sjh!=undefined) {
        console.log(localStorage.sjh)
	    $.ajax({
			url:'mvc/index.php?c=Login&a=query',
			type:'post',
			data:{
				shouji:localStorage.sjh,
			},success:function(data){
                
				var datas = JSON.parse(data)
                console.log(datas)
  //修改登陆的信息
     $('.defa').attr('src',datas.data.img)
     $('.Name').html(datas.data.name)
                //渲染
				$(datas.message).each(function(I,Item){
					var Html=`<li class="tab_content show">
				 <div class="circleList-d">
					<div class="circle-d-head">
						<a href="#" class="commentUser">
							<div class="user-img"><img src="${datas.data.img}"></div>
							<div class="user-name-d">
								<span>${datas.data.name}
								</span><br>
								<span class="issue-time">${Item.time}</span>
							</div>
						</a>
					</div>
					<p class="circle-d-text">${Item.neirong}</p>
					<ul class="circle-d-img">`
					     var imgurl = Item.img.split('-')
					   $(imgurl).each(function(i,item){
					   	  Html+=`<li><a href="javascript:;"><img src="${item}"></a></li>`
					   });
					Html+=`</ul>
				</div>
			    </li>`
           $('.circle-content').append(Html)
				})
				
			
			}
		})
	}else{
		alert('请登录');
		window.location.href='index.html';
	}
})    
        
		
	</script>
</body>
</html>